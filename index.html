<html>
<head>
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-7s5uDGW3AHqw6xtJmNNtr+OBRJUlgkNJEo78P4b0yRw= sha512-nNo+yCHEyn0smMxSswnf/OnX6/KwJuZTlNZBjauKhTK0c+zT+q5JOCx0UFhXQ6rJR9jg6Es8gPuD2uZcYDLqSw==" crossorigin="anonymous">
    <link href="http://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/sandstone/bootstrap.min.css" rel="stylesheet" integrity="sha256-oqtj+Pkh1c3dgdH6V9qoS7qwhOy2UZfyVK0qGLa9dCc= sha512-izanB/WZ07hzSPmLkdq82m5xS7EH/qDMgl5aWR37EII+rJOi5c6ouJ3PYnrw6K+DWQcnMZ+nO1NqDr6SBKLBDg==" crossorigin="anonymous">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha256-3dkvEK0WLHRJ7/Csr0BZjAWxERc5WH7bdeUya2aXxdU= sha512-+L4yy6FRcDGbXJ9mPG8MT/3UCDzwR9gPeyFNMCtInsol++5m3bk2bXWKdZjvybmohrAsn3Ua5x8gfLnbE1YkOg==" crossorigin="anonymous">

</head>
<body>
<a href="https://github.com/BinaryConstruct/FilamentCalculator"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
<div class="container">
    <div class="row">
        <div class="col-sm-12">
            <h2 class="text-center">Filament Calculator</h2>
            <div class="row">
                <div class="col-sm-6">
                    <form class="form-horizontal">
                        <fieldset>
                            <div class="form-group">
                              <label for="inputLength" class="col-lg-2 control-label">Length (mm)</label>
                              <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputLength" value="100" data-bind="value: length"></input>
                              </div>
                            </div>
                            <div class="form-group">
                              <label for="inputMaterial" class="col-lg-2 control-label">Material</label>
                              <div class="col-lg-10">
                                  <select class="form-control" id="inputMaterial" data-bind="options: availableMaterials,
                                                                                             optionsText: 'name',
                                                                                             value: material,">
                                  </select>
                              </div>
                            </div>
                            <div class="form-group">
                              <label for="inputDiameter" class="col-lg-2 control-label">Diameter (mm)</label>
                              <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputDiameter" value="3.00" data-bind="value: diameter"></input>
                              </div>
                            </div>
                            <div class="form-group">
                              <label for="inputCost" class="col-lg-2 control-label">$ / kg</label>
                              <div class="col-lg-10">
                                <input type="text" class="form-control" id="inputCost" value="30.0" data-bind="value: cost"></input>
                              </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
                <div class="col-sm-6">
                    <div class="alert  alert-danger" data-bind="visible: weight() > 1000">
                      <strong>Warning!</strong> Build weight <span data-bind="text: weight.extend({numeric: 4})"></span>g exceeds 1kg.
                    </div>
                    <div class="well">
                        <p>Material: <span data-bind="text: material() ? material().name : 'unknown'"></span></p>
                        <p>Length: <span data-bind="text: length.extend({numeric: 0})"></span> mm</p>
                        <p>Weight: <span data-bind="text: weight.extend({numeric: 0})"></span> g</p>
                        <p>Cost: $<span data-bind="text: price.extend({numeric: 2})"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Filament Calculator</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://binaryconstruct.github.io/FilamentCalculator/" property="cc:attributionName" rel="cc:attributionURL">BinaryConstruct</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/BinaryConstruct/FilamentCalculator" rel="dct:source">https://github.com/BinaryConstruct/FilamentCalculator</a>
        </div>
    </div>
</div>

<script type="text/javascript">

ko.extenders.numeric = function(target, precision) {
    var result = ko.dependentObservable({
         read: function() {
            return Number(target()).toFixed(precision);
         },
         write: target
     });

     result.raw = target;
     return result;
};

var vm = {
    availableMaterials: [
        {name: "PLA", density: 0.00125},
        {name: "ABS", density: 0.00105},
        {name: "PET", density: 0.00138},
        {name: "HDPE", density: 0.00097},
        {name: "PVA", density: 0.00119},
    ],
    material: ko.observable({name: "PLA", density: 0.00125}),
    cost: ko.observable(30.0),
    length: ko.observable(100.0),
    diameter: ko.observable(3.00),
};

vm.weight = ko.pureComputed(function () {
    var radius = this.diameter() / 2;
    var area = radius * radius * 3.1415926535897932384626433832795;
    var weight = area * this.length() * this.material().density;
    return weight;
}, vm);

vm.price = ko.pureComputed(function () {
    var price = (this.cost() / 1000.0) * this.weight();
    return price;
}, vm);

ko.applyBindings(vm);
</script>

</body>
</html>
